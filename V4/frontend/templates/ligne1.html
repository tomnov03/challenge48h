<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="../static/header.css">
    <link rel="stylesheet" href="../static/footer.css">
    <link rel="stylesheet" href="../static/ligne1.css">
    <title>Ligne 1 - M√©tro Lille</title> 

  

    <style>
        #map {
            width: 100%;
            height: 400px;  /* Hauteur d√©finie pour afficher la carte */
            margin-bottom: 20px;
        }
    </style>
</head>

<header>
    <div class="header-container">
        <div class="logo">
            <img src="../image/logomel.jpg" alt="Logo de la M√©tropole Europ√©enne de Lille">
        </div>
        <nav>
            <ul class="nav-menu">
              <li><a href="./">Accueil</a></li>
                <li class="dropdown">
                    <a>Actualit√© ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li><a href="./article1.html">Euralille 3000</a></li>
                        <li><a href="./article2.html">15 nouvelles rames...</a></li>
                        <li><a href="./article3.html">Ligne 1 du m√©tro...</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="active">Les lignes ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li class="subheader">M√©tro</li>
                        <li><a href="./ligne1.html">M√©tro Ligne 1</a></li>
                        <li><a href="./ligne2.html">M√©tro Ligne 2</a></li>
                        <li class="subheader">Bus</li>
                        <li><a href="./bus.html">En direct</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a>Infos Pratiques ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li class="subheader">V'Lille</li>
                        <li><a href="./vlille.html">Trouver un V'Lille</a></li>
                        <li class="subheader">Parking</li>
                        <li><a href="./parkings.html">Trouver une place de parking</a></li>
                    </ul>
                </li>
                <li><a href="./contact.html">Contact</a></li>
            </ul>
        </nav>
    </div>
  </header>



  <body>
    <div class="container">
        <!-- üìã Informations sur les stations -->
        <div id="stationsLigne1">
            <h2>Informations sur la station</h2>
            <p>S√©lectionnez une station pour voir les d√©tails.</p>
        </div>

        <!-- üó∫Ô∏è Carte des stations -->
        <div id="map"></div>
    </div>
</body>


<footer class="footer">
    <div class="footer-content">
      <!-- Section de gauche : Informations -->
      <div class="footer-section">
        <h3>M√©tropole Europ√©enne de Lille</h3>
        <p>&copy; 2025 M√©tropole Europ√©enne de Lille ‚Äì Ceci est un exemple</p>
        <p>Contactez-nous : <a href="mailto:contact@example.com">contact@example.com</a></p>
      </div>
  
      <!-- Section du milieu : Liens utiles -->
      <div class="footer-section">
        <h3>Liens utiles</h3>
        <ul>
          <li><a href="#">Accueil</a></li>
          <li><a href="#">Actualit√©s</a></li>
          <li><a href="#">Services</a></li>
          <li><a href="#">Contact</a></li>
        </ul>
      </div>
  
      <!-- Section de droite : R√©seaux sociaux -->
      <div class="footer-section">
        <h3>Suivez-nous</h3>
        <div class="social-icons">
          <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
          <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </div>
    </div>
  
    <!-- Barre du bas -->
    <div class="footer-bottom">
      <p>Con√ßu par les √©tudiants chez Ynov Campus</p>
    </div>
  </footer>
<script>
    async function fetchStationsLigne1() {
        try {
            const response = await fetch("/api/stations_metro");
            const stations = await response.json();
            const stationsLigne1 = stations.filter(station => station.ligne === "1"); // Filtrer les stations de la ligne 1
    
            // Initialiser la carte avec Leaflet
            const map = L.map('map').setView([50.62925, 3.057256], 13); // Centrer sur Lille
    
            // Ajouter une couche de tuiles (carte OpenStreetMap)
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
    
            // Fonction pour r√©cup√©rer l'adresse √† partir des coordonn√©es
            async function getAddressFromCoordinates(lat, lon) {
                try {
                    const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`);
                    const data = await response.json();
                    return data.display_name || "Adresse non disponible"; // Renvoyer l'adresse ou un message par d√©faut
                } catch (error) {
                    console.error("Erreur lors de la r√©cup√©ration de l'adresse :", error);
                    return "Adresse non disponible";
                }
            }
    
            // Ajouter les stations comme des marqueurs sur la carte
            stationsLigne1.forEach(station => {
                const coord = station.coordinates; // coord[0] = lon, coord[1] = lat
                L.marker([coord[1], coord[0]]) // Latitude, Longitude (coordonn√©e invers√©e)
                    .addTo(map)
                    .bindTooltip(station.nom_statio) // Afficher le nom de la station au survol
                    .on('click', async function () {
                        const address = await getAddressFromCoordinates(coord[1], coord[0]); // R√©cup√©rer l'adresse
                        document.getElementById("stationsLigne1").innerHTML = `
                            <h2>Informations de la station</h2>
                            <div>
                                <strong>${station.nom_statio}</strong> (${station.commune})<br>
                                Ligne: ${station.ligne} <br>
                                Adresse: ${address} <br>
                            </div>
                        `;
                    });
            });
        } catch (err) {
            console.error("Erreur lors de la r√©cup√©ration des stations de m√©tro :", err);
        }
    }
    
    window.onload = () => {
        fetchStationsLigne1(); // Charger les stations de la ligne 1 √† l'ouverture de la page
    };
    
    
</script>
</html>
